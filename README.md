# DeepSeek-v2-MoE-MLA-DLB_and_CB-Loss-Implementation
Self-implementation of** Device-Level Balance Loss** and** Communication Balance Loss** of DeepSeek v2 Tech Report（Not Given in Official Code）

## Project Introduction
The [Official Code](https://huggingface.co/deepseek-ai/DeepSeek-V2/blob/main/modeling_deepseek.py) only gives the implementation of Aux Loss and LM Loss:
![image](https://github.com/JerryYin777/DeepSeek-v2-MoE-MLA-DLB_and_CB-Loss-Implementation/assets/88324880/b28b20cf-e9ec-4691-ac13-398390947f55)

So I decided to implement the other two losses: Device-Level Balance Loss and Communication Balance Loss:
![image](https://github.com/JerryYin777/DeepSeek-v2-MoE-MLA-DLB_and_CB-Loss-Implementation/assets/88324880/4430ac2b-c87c-4436-9dd5-22469d1eb7bd)

![image](https://github.com/JerryYin777/DeepSeek-v2-MoE-MLA-DLB_and_CB-Loss-Implementation/assets/88324880/5ab55cab-230c-4a3f-b618-2cfdad26c27b)

## Implementation Details

TODO
